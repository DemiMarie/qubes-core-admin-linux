# do not edit this file, it will be overwritten on update

ACTION=="remove", GOTO="qubes-ignore-devices-end"
SUBSYSTEM!="block", GOTO="qubes-ignore-devices-end"
KERNEL=="loop*", ENV{DM_UDEV_DISABLE_DISK_RULES_FLAG}="1", ENV{UDEV_DISABLE_PERSISTENT_STORAGE_RULES_FLAG}="1"
KERNEL=="xvd*", ENV{DM_UDEV_DISABLE_DISK_RULES_FLAG}="1", ENV{UDEV_DISABLE_PERSISTENT_STORAGE_RULES_FLAG}="1"
# ENV{DM_NAME} not available yet
# Template VM disks
ATTR{dm/name}=="snapshot-*", ENV{DM_UDEV_DISABLE_DISK_RULES_FLAG}="1"
ATTR{dm/name}=="origin-*", ENV{DM_UDEV_DISABLE_DISK_RULES_FLAG}="1"
# kpartx used for creating empty volatile.img, udevd tries to access the device
# and prevent kpartx from removing them
ATTR{dm/name}=="loop*p*", ENV{DM_UDEV_DISABLE_DISK_RULES_FLAG}="1"

LABEL="qubes-ignore-devices-end"

# vim: set ft=udevrules ff=unix fenc=UTF-8 eol:
